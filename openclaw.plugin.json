{
  "id": "moltguard",
  "name": "MoltGuard",
  "description": "Local prompt sanitization and prompt injection detection powered by MoltGuard",
  "version": "6.0.0",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "enabled": {
        "type": "boolean",
        "description": "Enable or disable the guard (default: true)"
      },
      "sanitizePrompt": {
        "type": "boolean",
        "description": "Enable local prompt sanitization via gateway (default: false)"
      },
      "gatewayPort": {
        "type": "number",
        "description": "Port for the local sanitization gateway (default: 8900)"
      },
      "gatewayAutoStart": {
        "type": "boolean",
        "description": "Automatically start the gateway when plugin loads (default: true)"
      },
      "blockOnRisk": {
        "type": "boolean",
        "description": "Block tool calls when injection is detected (default: true)"
      },
      "apiKey": {
        "type": "string",
        "description": "MoltGuard API key (optional â€” auto-registered if missing)"
      },
      "timeoutMs": {
        "type": "number",
        "description": "Timeout for analysis in milliseconds (default: 60000)"
      },
      "logPath": {
        "type": "string",
        "description": "Path to directory for JSONL log files (default: ~/.openclaw/logs)"
      },
      "autoRegister": {
        "type": "boolean",
        "description": "Automatically register an API key if apiKey is missing (default: true)"
      },
      "apiBaseUrl": {
        "type": "string",
        "description": "MoltGuard API base URL (default: https://api.moltguard.com)"
      },
      "vaultTtlSeconds": {
        "type": "number",
        "description": "TTL in seconds for token vault entries. Controls how long PII-to-placeholder mappings persist for cross-turn consistency. (default: 3600)"
      }
    }
  },
  "uiHints": {
    "enabled": {
      "label": "Enable Guard",
      "help": "Enable or disable prompt injection detection"
    },
    "sanitizePrompt": {
      "label": "Sanitize Prompts",
      "help": "Enable local prompt sanitization to protect sensitive data (bank cards, passwords, etc.) before sending to LLM. Requires gateway."
    },
    "gatewayPort": {
      "label": "Gateway Port",
      "help": "Port for the local sanitization gateway",
      "advanced": true
    },
    "gatewayAutoStart": {
      "label": "Auto-start Gateway",
      "help": "Automatically start the gateway process when OpenClaw starts",
      "advanced": true
    },
    "blockOnRisk": {
      "label": "Block on Risk",
      "help": "Block tool calls when prompt injection is detected"
    },
    "apiKey": {
      "label": "API Key",
      "help": "Your MoltGuard API key. Leave blank for automatic registration on first use.",
      "advanced": true
    },
    "timeoutMs": {
      "label": "Timeout (ms)",
      "help": "Maximum time for analysis",
      "advanced": true
    },
    "logPath": {
      "label": "Log Directory",
      "help": "Custom path for the JSONL analysis log files",
      "advanced": true
    },
    "autoRegister": {
      "label": "Auto-register API Key",
      "help": "If enabled and apiKey is empty, MoltGuard will register a key on first use. Disable for strict no-network/managed deployments.",
      "advanced": true
    },
    "apiBaseUrl": {
      "label": "API Base URL",
      "help": "Override the MoltGuard API endpoint (e.g. staging or self-hosted).",
      "advanced": true
    },
    "vaultTtlSeconds": {
      "label": "Vault TTL (seconds)",
      "help": "How long token vault entries persist for cross-turn placeholder consistency. Lower values enforce stricter data minimization.",
      "advanced": true
    }
  }
}
